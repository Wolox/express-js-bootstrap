const logger = require('../logger');
const { receivedTokenHeader } = require('../../config/constants')
const { storedToken } = require('../../config/environment')

exports.verifyDocumentationToken = (req, res, next) => {
  const receivedToken = req.headers[receivedTokenHeader];

  if (!receivedToken) return next({ internalCode: 401, message: 'The token was not given' });

  if (receivedToken !== storedToken) {
    return next({ internalCode: 401, message: 'The given documentation token was incorrect' });
  }

  logger.info('Successful Authentication.');
  return next();
};
