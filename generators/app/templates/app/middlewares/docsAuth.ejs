const logger = require('../logger');
const { config.common.headers.documetationTokenHeader } = require('../../config/index');
const { config.common.session.documentationToken } = require('../../config/index');

exports.verifyDocumentationToken = (req, res, next) => {
  const receivedDocumentationToken = req.headers[documentationTokenHeader];

  if (!receivedDocumentationToken) return next({ internalCode: 401, message: 'The token was not given' });

  if (receivedDocumentationToken !== documentationToken) {
    return next({ internalCode: 401, message: 'The given documentation token was incorrect' });
  }

  logger.info('Successful Authentication.');
  return next();
};
